/*
===========================================================
‚úÖ CHECK Constraint ‚Äî PostgreSQL ‡¶è ‡¶∏‡¶¨‡¶ß‡¶∞‡¶®‡ßá‡¶∞ ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞
===========================================================
‡¶è‡¶ü‡¶æ programing hero ‡¶è‡¶∞ module ‡¶è‡¶∞ ‡¶¨‡¶æ‡¶á‡¶∞‡ßá 
extra content‡•§

CHECK constraint ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º ‡¶è‡¶Æ‡¶® ‡¶∂‡¶∞‡ßç‡¶§ ‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡¶§‡ßá,
‡¶Ø‡¶æ‡¶§‡ßá ‡¶ï‡ßã‡¶®‡ßã column-‡¶è ‡¶≠‡ßÅ‡¶≤, ‡¶Ö‡¶ó‡ßç‡¶∞‡¶π‡¶£‡¶Ø‡ßã‡¶ó‡ßç‡¶Ø ‡¶¨‡¶æ invalid ‡¶°‡ßá‡¶ü‡¶æ ‡¶¢‡ßÅ‡¶ï‡¶§‡ßá ‡¶®‡¶æ ‡¶™‡¶æ‡¶∞‡ßá‡•§

Syntax:
CHECK (condition)
*/

/*
-----------------------------------------------------------
1Ô∏è‚É£  Value Range Checking (‡¶∏‡ßÄ‡¶Æ‡¶æ ‡¶®‡¶ø‡¶∞‡ßç‡¶ß‡¶æ‡¶∞‡¶£)
-----------------------------------------------------------
‡¶â‡¶¶‡¶æ‡¶π‡¶∞‡¶£: ‡¶¨‡ßü‡¶∏ 0‚Äì120 ‡¶è‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶π‡¶§‡ßá ‡¶π‡¶¨‡ßá
*/
`age INT CHECK (age >= 0 AND age <= 120)`;

// ‡¶¨‡¶æ short form:
`age INT CHECK (age BETWEEN 0 AND 120)`;

/*
-----------------------------------------------------------
2Ô∏è‚É£  Positive / Negative Number Checking
-----------------------------------------------------------
‡¶∂‡ßÅ‡¶ß‡ßÅ positive ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ:
*/
`price INT CHECK (price > 0)`;

// Negative ‡¶π‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡¶¨‡ßá ‡¶®‡¶æ:
`balance INT CHECK (balance >= 0)`;

/*
-----------------------------------------------------------
3Ô∏è‚É£  Text Pattern Checking (LIKE)
-----------------------------------------------------------
Email ‡¶Ö‡¶¨‡¶∂‡ßç‡¶Ø‡¶á @ ‡¶•‡¶æ‡¶ï‡¶§‡ßá ‡¶π‡¶¨‡ßá:
*/
`email TEXT CHECK (email LIKE '%@%')`;

// Phone ‡¶Ö‡¶¨‡¶∂‡ßç‡¶Ø‡¶á digit ‡¶π‡¶§‡ßá ‡¶π‡¶¨‡ßá:
`phone TEXT CHECK (phone ~ '^[0-9]+$')`;
// ( ~ ‡¶Æ‡¶æ‡¶®‡ßá regular expression match )

/*
-----------------------------------------------------------
4Ô∏è‚É£  Limited Choice (ENUM-‡¶è‡¶∞ ‡¶Æ‡¶§‡ßã ‡¶Ü‡¶ö‡¶∞‡¶£)
-----------------------------------------------------------
gender ‡¶∂‡ßÅ‡¶ß‡ßÅ‡¶Æ‡¶æ‡¶§‡ßç‡¶∞ ‚ÄúMale/Female/Other‚Äù ‡¶π‡¶¨‡ßá:
*/
`gender TEXT CHECK (gender IN ('Male', 'Female', 'Other'))`;

// status ‡¶Ö‡¶¨‡¶∂‡ßç‡¶Ø‡¶á Active/Inactive:
`status TEXT CHECK (status IN ('active', 'inactive'))`;

/*
-----------------------------------------------------------
5Ô∏è‚É£  Date Validation
-----------------------------------------------------------
Future date ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶¨‡ßá ‡¶®‡¶æ:
*/
`created_at DATE CHECK (created_at <= CURRENT_DATE)`;

// Age ‡¶Ö‡¶¨‡¶∂‡ßç‡¶Ø‡¶á 18+ ‡¶π‡¶§‡ßá ‡¶π‡¶¨‡ßá:
`birth_date DATE CHECK (birth_date <= CURRENT_DATE - INTERVAL '18 years')`;

/*
-----------------------------------------------------------
6Ô∏è‚É£  Multiple Column Based Check
-----------------------------------------------------------
Start date ‡¶Ö‡¶¨‡¶∂‡ßç‡¶Ø‡¶á end date ‡¶è‡¶∞ ‡¶Ü‡¶ó‡ßá:
*/
`CHECK (start_date < end_date)`;

// Discount price ‡¶Ö‡¶¨‡¶∂‡ßç‡¶Ø‡¶á original price ‡¶è‡¶∞ ‡¶ö‡ßá‡¶Ø‡¶º‡ßá ‡¶ï‡¶Æ ‡¶π‡¶¨‡ßá:
`CHECK (discount < price)`;

/*
-----------------------------------------------------------
7Ô∏è‚É£  Conditional Check (OR Logic)
-----------------------------------------------------------
phone ‡¶¨‡¶æ email ‚Äî ‡¶Ø‡ßá‡¶ï‡ßã‡¶®‡ßã ‡¶è‡¶ï‡¶ü‡¶ø ‡¶Ö‡¶¨‡¶∂‡ßç‡¶Ø‡¶á ‡¶•‡¶æ‡¶ï‡¶§‡ßá ‡¶π‡¶¨‡ßá:
*/
`CHECK (phone IS NOT NULL OR email IS NOT NULL)`;

/*
-----------------------------------------------------------
8Ô∏è‚É£  Prevent Empty String ("" block ‡¶ï‡¶∞‡¶æ)
-----------------------------------------------------------
Name empty string ‡¶π‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡¶¨‡ßá ‡¶®‡¶æ:
*/
`name TEXT CHECK (name <> '')`;

/*
-----------------------------------------------------------
9Ô∏è‚É£  Validate Percentage Range
-----------------------------------------------------------
Marks ‡¶Ö‡¶¨‡¶∂‡ßç‡¶Ø‡¶á 0‚Äì100 ‡¶∞‡ßá‡¶û‡ßç‡¶ú‡ßá ‡¶•‡¶æ‡¶ï‡¶¨‡ßá:
*/
`marks INT CHECK (marks BETWEEN 0 AND 100)`;

// Discount percentage:
`discount INT CHECK (discount >= 0 AND discount <= 50)`;

/*
-----------------------------------------------------------
üîü  Regular Expression ( ‡¶ï‡¶†‡¶ø‡¶® validation )
-----------------------------------------------------------
Strong password example:
*/
`password TEXT CHECK (password ~ '^(?=.*[A-Z])(?=.*[0-9]).{6,}$')`;
// Meaning:
// - At least 1 capital letter
// - At least 1 number
// - Minimum length 6

/*
===========================================================
‚≠ê ‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶ü‡ßá‡¶¨‡¶ø‡¶≤ ‡¶â‡¶¶‡¶æ‡¶π‡¶∞‡¶£ ‚Äî ‡¶¨‡¶ø‡¶≠‡¶ø‡¶®‡ßç‡¶® CHECK ‡¶è‡¶ï‡¶∏‡¶æ‡¶•‡ßá ‚≠ê
===========================================================
*/
`CREATE TABLE users (
   id SERIAL PRIMARY KEY,
   age INT CHECK (age BETWEEN 1 AND 120),
   gender TEXT CHECK (gender IN ('Male','Female','Other')),
   email TEXT CHECK (email LIKE '%@%'),
   created_at DATE CHECK (created_at <= CURRENT_DATE)
 );`;

/*
===========================================================
üî• CHECK Constraint Benefits
===========================================================

‚úî ‡¶≠‡ßÅ‡¶≤ ‡¶°‡ßá‡¶ü‡¶æ ‡¶°‡¶æ‡¶ü‡¶æ‡¶¨‡ßá‡¶ú‡ßá ‡¶Ø‡ßá‡¶§‡ßá‡¶á ‡¶™‡¶æ‡¶∞‡¶¨‡ßá ‡¶®‡¶æ
‚úî Business rules table level-‡¶è enforce ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡ßü
‚úî Application layer error ‡¶ï‡¶Æ‡ßá
‚úî Data integrity ‡¶¨‡¶ú‡¶æ‡ßü ‡¶•‡¶æ‡¶ï‡ßá

===========================================================
üìå NOTE:
CHECK constraint ‡¶∏‡¶¨‡¶∏‡¶Æ‡ßü column-‡¶è‡¶∞ type ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡ßü‡ßÄ valid ‡¶•‡¶æ‡¶ï‡¶§‡ßá ‡¶π‡¶¨‡ßá‡•§
Type mismatch ‡¶π‡¶≤‡ßá PostgreSQL error ‡¶¶‡ßá‡¶¨‡ßá‡•§
===========================================================
*/
